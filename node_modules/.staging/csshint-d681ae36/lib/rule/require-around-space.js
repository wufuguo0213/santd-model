'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.check = undefined;

var _chalk = require('chalk');

var _chalk2 = _interopRequireDefault(_chalk);

var _postcss = require('postcss');

var _postcss2 = _interopRequireDefault(_postcss);

var _util = require('../util');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * 当前文件所代表的规则名称
 *
 * @const
 * @type {string}
 */
var RULENAME = 'require-around-space';

/**
 * css 组合的正则匹配
 *
 * @const
 * @type {RegExp}
 */
/**
 * @file require-around-space 的检测逻辑
 *       `>`, `+`, `~` 对应 009: [强制] `>`、`+`、`~` 选择器的两边各保留一个空格。
 * @author ielgnaw(wuji0223@gmail.com)
 */

var PATTERN_COMBINATORS = /[^\s>+~=]+/g; // 排除 ~=, +=, >=

/**
 * 获取错误信息
 *
 * @param {string} combinator 组合的字符
 *
 * @return {string} 错误信息
 */
var getMsg = function getMsg(combinator) {
    return '' + 'Around the `' + combinator + '` selector will keep a space';
};

var arrayProto = Array.prototype;

/**
 * 具体的检测逻辑
 *
 * @param {Object} opts 参数
 * @param {*} opts.ruleVal 当前规则具体配置的值
 * @param {string} opts.fileContent 文件内容
 * @param {string} opts.filePath 文件路径
 */
var check = exports.check = _postcss2.default.plugin(RULENAME, function (opts) {
    return function (css, result) {

        var ruleVal = opts.ruleVal;
        var realRuleVal = [];
        arrayProto.push[Array.isArray(ruleVal) ? 'apply' : 'call'](realRuleVal, ruleVal);

        if (realRuleVal.length) {

            var invalidList = [];
            css.walkRules(function (rule) {
                /* jshint maxcomplexity: 11 */
                var selector = rule.selector;

                // 排除掉 .aaa:nth-child(4n+1) 这样的选择器
                selector = selector.replace(/\([\s\S]*?\)/g, '');

                var segments = selector.split(PATTERN_COMBINATORS);
                var len = segments.length;

                for (var i = 0; i < len; i++) {
                    var segment = segments[i];

                    if (!segment) {
                        continue;
                    }

                    var lastChar = segment.slice(-1);
                    var firstChar = segment.slice(0, 1);
                    if (segment) {
                        segment = (0, _util.trim)(segment);
                        if (realRuleVal.indexOf(segment) <= -1) {
                            continue;
                        }

                        if (i === 0) {
                            if (lastChar !== ' ') {
                                invalidList.push({
                                    invalidChar: segment,
                                    rule: rule
                                });
                                continue;
                            }
                        } else if (i === len - 1) {
                            if (firstChar !== ' ') {
                                invalidList.push({
                                    invalidChar: segment,
                                    rule: rule
                                });
                                continue;
                            }
                        } else {
                            if (lastChar !== ' ' || firstChar !== ' ') {
                                invalidList.push({
                                    invalidChar: segment,
                                    rule: rule
                                });
                                continue;
                            }
                        }
                    }
                }
            });

            invalidList.forEach(function (invalidRule) {
                var invalidChar = invalidRule.invalidChar,
                    rule = invalidRule.rule;

                var msg = getMsg(invalidRule.invalidChar);
                var source = rule.source;
                var line = source.start.line;
                var lineContent = (0, _util.getLineContent)(line, source.input.css);
                var col = lineContent.indexOf(invalidChar);
                result.warn(RULENAME, {
                    node: rule,
                    ruleName: RULENAME,
                    errorChar: invalidChar,
                    line: line,
                    col: col + 1,
                    message: msg,
                    colorMessage: '`' + lineContent.replace(invalidChar, _chalk2.default.magenta(invalidChar)) + '` ' + _chalk2.default.grey(msg)
                });
                global.CSSHINT_INVALID_ALL_COUNT++;
            });
        }
    };
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9ydWxlL3JlcXVpcmUtYXJvdW5kLXNwYWNlLmpzIl0sIm5hbWVzIjpbIlJVTEVOQU1FIiwiUEFUVEVSTl9DT01CSU5BVE9SUyIsImdldE1zZyIsImNvbWJpbmF0b3IiLCJhcnJheVByb3RvIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJjaGVjayIsInBvc3Rjc3MiLCJwbHVnaW4iLCJjc3MiLCJyZXN1bHQiLCJydWxlVmFsIiwib3B0cyIsInJlYWxSdWxlVmFsIiwicHVzaCIsImlzQXJyYXkiLCJsZW5ndGgiLCJpbnZhbGlkTGlzdCIsIndhbGtSdWxlcyIsInNlbGVjdG9yIiwicnVsZSIsInJlcGxhY2UiLCJzZWdtZW50cyIsInNwbGl0IiwibGVuIiwiaSIsInNlZ21lbnQiLCJsYXN0Q2hhciIsInNsaWNlIiwiZmlyc3RDaGFyIiwiaW5kZXhPZiIsImludmFsaWRDaGFyIiwiZm9yRWFjaCIsImludmFsaWRSdWxlIiwibXNnIiwic291cmNlIiwibGluZSIsInN0YXJ0IiwibGluZUNvbnRlbnQiLCJpbnB1dCIsImNvbCIsIndhcm4iLCJub2RlIiwicnVsZU5hbWUiLCJlcnJvckNoYXIiLCJtZXNzYWdlIiwiY29sb3JNZXNzYWdlIiwiY2hhbGsiLCJtYWdlbnRhIiwiZ3JleSIsImdsb2JhbCIsIkNTU0hJTlRfSU5WQUxJRF9BTExfQ09VTlQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFNQTs7OztBQUNBOzs7O0FBRUE7Ozs7QUFFQTs7Ozs7O0FBTUEsSUFBTUEsV0FBVyxzQkFBakI7O0FBRUE7Ozs7OztBQW5CQTs7Ozs7O0FBeUJBLElBQU1DLHNCQUFzQixhQUE1QixDLENBQTJDOztBQUUzQzs7Ozs7OztBQU9BLElBQU1DLFNBQVMsU0FBVEEsTUFBUztBQUFBLFdBQ1gsS0FDTSxjQUROLEdBRU1DLFVBRk4sR0FHTSw4QkFKSztBQUFBLENBQWY7O0FBTUEsSUFBTUMsYUFBYUMsTUFBTUMsU0FBekI7O0FBRUE7Ozs7Ozs7O0FBUU8sSUFBTUMsd0JBQVFD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QVNYLEdBTlM7QUFPbEJZLGtDQUFjLE1BQ1JSLFlBQVlqQixPQUFaLENBQW9CVSxXQUFwQixFQUFpQ2dCLGdCQUFNQyxPQUFOLENBQWNqQixXQUFkLENBQWpDLENBRFEsR0FFUixJQUZRLEdBR1JnQixnQkFBTUUsSUFBTixDQUFXZixHQUFYO0FBVlksaUJBQXRCO0FBWUFnQix1QkFBT0MseUJBQVA7QUFDSCxhQXBCRDtBQXFCSDtBQUNKLEtBeEZ5QztBQUFBLENBQXpCLENBQWQiLCJmaWxlIjoicmVxdWlyZS1hcm91bmQtc3BhY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIHJlcXVpcmUtYXJvdW5kLXNwYWNlIOeahOajgOa1i+mAu+i+kVxuICogICAgICAgYD5gLCBgK2AsIGB+YCDlr7nlupQgMDA5OiBb5by65Yi2XSBgPmDjgIFgK2DjgIFgfmAg6YCJ5oup5Zmo55qE5Lik6L655ZCE5L+d55WZ5LiA5Liq56m65qC844CCXG4gKiBAYXV0aG9yIGllbGduYXcod3VqaTAyMjNAZ21haWwuY29tKVxuICovXG5cbmltcG9ydCBjaGFsayBmcm9tICdjaGFsayc7XG5pbXBvcnQgcG9zdGNzcyBmcm9tICdwb3N0Y3NzJztcblxuaW1wb3J0IHtnZXRMaW5lQ29udGVudCwgdHJpbX0gZnJvbSAnLi4vdXRpbCc7XG5cbi8qKlxuICog5b2T5YmN5paH5Lu25omA5Luj6KGo55qE6KeE5YiZ5ZCN56ewXG4gKlxuICogQGNvbnN0XG4gKiBAdHlwZSB7c3RyaW5nfVxuICovXG5jb25zdCBSVUxFTkFNRSA9ICdyZXF1aXJlLWFyb3VuZC1zcGFjZSc7XG5cbi8qKlxuICogY3NzIOe7hOWQiOeahOato+WImeWMuemFjVxuICpcbiAqIEBjb25zdFxuICogQHR5cGUge1JlZ0V4cH1cbiAqL1xuY29uc3QgUEFUVEVSTl9DT01CSU5BVE9SUyA9IC9bXlxccz4rfj1dKy9nOyAvLyDmjpLpmaQgfj0sICs9LCA+PVxuXG4vKipcbiAqIOiOt+WPlumUmeivr+S/oeaBr1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb21iaW5hdG9yIOe7hOWQiOeahOWtl+esplxuICpcbiAqIEByZXR1cm4ge3N0cmluZ30g6ZSZ6K+v5L+h5oGvXG4gKi9cbmNvbnN0IGdldE1zZyA9IGNvbWJpbmF0b3IgPT5cbiAgICAnJ1xuICAgICAgICArICdBcm91bmQgdGhlIGAnXG4gICAgICAgICsgY29tYmluYXRvclxuICAgICAgICArICdgIHNlbGVjdG9yIHdpbGwga2VlcCBhIHNwYWNlJztcblxuY29uc3QgYXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZTtcblxuLyoqXG4gKiDlhbfkvZPnmoTmo4DmtYvpgLvovpFcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0cyDlj4LmlbBcbiAqIEBwYXJhbSB7Kn0gb3B0cy5ydWxlVmFsIOW9k+WJjeinhOWImeWFt+S9k+mFjee9rueahOWAvFxuICogQHBhcmFtIHtzdHJpbmd9IG9wdHMuZmlsZUNvbnRlbnQg5paH5Lu25YaF5a65XG4gKiBAcGFyYW0ge3N0cmluZ30gb3B0cy5maWxlUGF0aCDmlofku7bot6/lvoRcbiAqL1xuZXhwb3J0IGNvbnN0IGNoZWNrID0gcG9zdGNzcy5wbHVnaW4oUlVMRU5BTUUsIG9wdHMgPT5cbiAgICAoY3NzLCByZXN1bHQpID0+IHtcblxuICAgICAgICBjb25zdCBydWxlVmFsID0gb3B0cy5ydWxlVmFsO1xuICAgICAgICBjb25zdCByZWFsUnVsZVZhbCA9IFtdO1xuICAgICAgICBhcnJheVByb3RvLnB1c2hbQXJyYXkuaXNBcnJheShydWxlVmFsKSA/ICdhcHBseScgOiAnY2FsbCddKHJlYWxSdWxlVmFsLCBydWxlVmFsKTtcblxuICAgICAgICBpZiAocmVhbFJ1bGVWYWwubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgIGNvbnN0IGludmFsaWRMaXN0ID0gW107XG4gICAgICAgICAgICBjc3Mud2Fsa1J1bGVzKHJ1bGUgPT4ge1xuICAgICAgICAgICAgICAgIC8qIGpzaGludCBtYXhjb21wbGV4aXR5OiAxMSAqL1xuICAgICAgICAgICAgICAgIGxldCBzZWxlY3RvciA9IHJ1bGUuc2VsZWN0b3I7XG5cbiAgICAgICAgICAgICAgICAvLyDmjpLpmaTmjokgLmFhYTpudGgtY2hpbGQoNG4rMSkg6L+Z5qC355qE6YCJ5oup5ZmoXG4gICAgICAgICAgICAgICAgc2VsZWN0b3IgPSBzZWxlY3Rvci5yZXBsYWNlKC9cXChbXFxzXFxTXSo/XFwpL2csICcnKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHNlZ21lbnRzID0gc2VsZWN0b3Iuc3BsaXQoUEFUVEVSTl9DT01CSU5BVE9SUyk7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVuID0gc2VnbWVudHMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2VnbWVudCA9IHNlZ21lbnRzW2ldO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2VnbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXN0Q2hhciA9IHNlZ21lbnQuc2xpY2UoLTEpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaXJzdENoYXIgPSBzZWdtZW50LnNsaWNlKDAsIDEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VnbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VnbWVudCA9IHRyaW0oc2VnbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVhbFJ1bGVWYWwuaW5kZXhPZihzZWdtZW50KSA8PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXN0Q2hhciAhPT0gJyAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludmFsaWRMaXN0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52YWxpZENoYXI6IHNlZ21lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlOiBydWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpID09PSBsZW4gLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0Q2hhciAhPT0gJyAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludmFsaWRMaXN0LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52YWxpZENoYXI6IHNlZ21lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlOiBydWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdENoYXIgIT09ICcgJyB8fCBmaXJzdENoYXIgIT09ICcgJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZhbGlkTGlzdC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludmFsaWRDaGFyOiBzZWdtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZTogcnVsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGludmFsaWRMaXN0LmZvckVhY2goaW52YWxpZFJ1bGUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHtpbnZhbGlkQ2hhciwgcnVsZX0gPSBpbnZhbGlkUnVsZTtcbiAgICAgICAgICAgICAgICBjb25zdCBtc2cgPSBnZXRNc2coaW52YWxpZFJ1bGUuaW52YWxpZENoYXIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IHJ1bGUuc291cmNlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBzb3VyY2Uuc3RhcnQubGluZTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lQ29udGVudCA9IGdldExpbmVDb250ZW50KGxpbmUsIHNvdXJjZS5pbnB1dC5jc3MpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbCA9IGxpbmVDb250ZW50LmluZGV4T2YoaW52YWxpZENoYXIpO1xuICAgICAgICAgICAgICAgIHJlc3VsdC53YXJuKFJVTEVOQU1FLCB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGU6IHJ1bGUsXG4gICAgICAgICAgICAgICAgICAgIHJ1bGVOYW1lOiBSVUxFTkFNRSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JDaGFyOiBpbnZhbGlkQ2hhcixcbiAgICAgICAgICAgICAgICAgICAgbGluZTogbGluZSxcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2wgKyAxLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtc2csXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yTWVzc2FnZTogJ2AnXG4gICAgICAgICAgICAgICAgICAgICAgICArIGxpbmVDb250ZW50LnJlcGxhY2UoaW52YWxpZENoYXIsIGNoYWxrLm1hZ2VudGEoaW52YWxpZENoYXIpKVxuICAgICAgICAgICAgICAgICAgICAgICAgKyAnYCAnXG4gICAgICAgICAgICAgICAgICAgICAgICArIGNoYWxrLmdyZXkobXNnKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGdsb2JhbC5DU1NISU5UX0lOVkFMSURfQUxMX0NPVU5UKys7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbik7XG4iXX0=